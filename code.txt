package com.example.messaging.socket;

import java.net.Socket;
import java.util.Map;
import java.util.concurrent.ConcurrentHashMap;

/**
 * Socket会话管理器
 */
public class SocketSessionManager {
    private final Map<String, Socket> sockets = new ConcurrentHashMap<>();
    private final Map<Socket, String> socketIds = new ConcurrentHashMap<>();
    private final Map<String, String> clientToSocket = new ConcurrentHashMap<>();
    
    public void addSocket(String socketId, Socket socket) {
        sockets.put(socketId, socket);
        socketIds.put(socket, socketId);
    }
    
    public void removeSocket(String socketId) {
        Socket socket = sockets.remove(socketId);
        if (socket != null) {
            socketIds.remove(socket);
            clientToSocket.values().remove(socketId);
        }
    }
    
    public Socket getSocket(String socketId) {
        return sockets.get(socketId);
    }
    
    public String getSocketId(Socket socket) {
        return socketIds.get(socket);
    }
    
    public void registerClientId(String socketId, String clientId) {
        clientToSocket.put(clientId, socketId);
    }
    
    public String getSocketIdByClient(String clientId) {
        return clientToSocket.get(clientId);
    }
}